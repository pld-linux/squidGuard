#----------------------------------------------------------------
#   DO NOT MODIFY THIS FILE AS IT IS MODIFIED BY THE TEMPLATE
#----------------------------------------------------------------
#   SquidGuard CONFIGURATION FILE
#----------------------------------------------------------------

# CONFIGURATION DIRECTORIES
dbhome /etc/squidGuard/db
logdir /var/log/squidGuard

# TIME RULES:
# abbrev for weekdays: 
# s = sun, m = mon, t =tue, w = wed, h = thu, f = fri, a = sat

# SOURCE ADDRESSES:
src privilegedsource {
	iplist privilegedsource/ips
}

src bannedsource {
	iplist bannedsource/ips
}

src lansource {
	iplist lansource/lan
}

# DESTINATION CLASSES:
dest porn {
    domainlist blacklists/porn/domains
    urllist porn/urls
    expressionlist porn/expressions
}

dest adult {
    domainlist blacklists/adult/domains
    urllist adult/urls
    expressionlist adult/expressions
}

dest audio-video {
    domainlist blacklists/audio-video/domains
    urllist audio-video/urls
}

dest forums {
    domainlist blacklists/forums/domains
    urllist forums/urls
    expressionlist forums/expressions
}

dest hacking {
    domainlist blacklists/hacking/domains
    urllist hacking/urls
}

dest redirector {
    domainlist blacklists/redirector/domains
    urllist redirector/urls
    expressionlist redirector/expressions
}

dest warez {
    domainlist blacklists/warez/domains
    urllist warez/urls
}

dest ads {
    domainlist blacklists/ads/domains
    urllist ads/urls
}

dest aggressive {
    domainlist blacklists/aggressive/domains
    urllist aggressive/urls
}

dest drugs {
    domainlist blacklists/drugs/domains
    urllist drugs/urls
}

dest gambling {
    domainlist blacklists/gambling/domains
    urllist gambling/urls
}

dest publicite {
    domainlist blacklists/publicite/domains
    urllist publicite/urls
    expressionlist publicite/expressions
}

dest violence {
    domainlist blacklists/violence/domains
    urllist violence/urls
    expressionlist violence/expressions
}


dest banneddestination {
	domainlist blacklists/banneddestination/domains
	urllist banneddestination/urls
	expressionlist banneddestination/expressions
}

dest advertising {
	domainlist blacklists/advertising/domains
	urllist advertising/urls
	redirect http://127.0.0.1:8444/nulbanner.png
	log /var/log/squidGuard/advertising.log
}

# ACLs
acl {
	privilegedsource {
		pass !advertising all
		redirect http://127.0.0.1:8444/squidGuard.cgi?clientaddr=%a&srcclass=%s&targetclass=%t&url=%u

	}
	
	bannedsource {
		pass none
		redirect http://127.0.0.1:8444/squidGuard.cgi?clientaddr=%a&srcclass=%s&targetclass=%t&url=%u

	}

	lansource {
		pass !adult !audio-video !forums !hacking !redirector !warez !ads !aggressive !drugs !gambling !publicite !violence !banneddestination !advertising all
		redirect http://127.0.0.1:8444/squidGuard.cgi?clientaddr=%a&srcclass=%s&targetclass=%t&url=%u
	}

	
	default {
		pass none
		redirect http://127.0.0.1:8444/squidGuard.cgi?clientaddr=%a&srcclass=%s&targetclass=%t&url=%u

	}
}
